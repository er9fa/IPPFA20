<!DOCTYPE html>
<html>

<head>
  <!-- bringing in some fonts from https://artisanthemes.io/best-google-fonts-combinations-modern-agency-website/-->
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700|Montserrat:300" rel="stylesheet">
  <meta charset="utf-8">
  <!--script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script-->
  <!-- page title -->
  <div class='center'>
    <h1>Stock Finder</h1>
  </div>

  <link rel="stylesheet" href="jquery-ui.min.css">
  <script src="jquery-3.5.1.min.js"></script>
  <script src="jquery.marquee.min.js"></script>
  <script src="jquery-ui.min.js"></script>
  <style>

  /* page background */
  body {
    background-color: #353840;
    color: #ffce00;
    font-family: 'Montserrat', sans-serif;
  }

  /* center aligning everything for the object */
  .center {
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }

  /* center aligning text */
  .text-center {
    text-align: center;
  }

  /* creating a slider class */
  .rangeslider {
    text-align: left;
    font-size: medium;
    margin-bottom: 3px;
  }

  /* nav menu for tabs */
  .navmenu {
    padding: 8px 50px;
    background: transparent;
    color: #ffce00;
    font-weight: 100;
    font-family: 'Montserrat', sans-serif;
    font-size: 20px;
    text-align: center;
    border-radius: 5px;
    border: 2px solid white;
  }
  #wrapper {
    display: flex;
    justify-content: center;
  }
  #wrapper > div {
    float: left;
    margin-right: 2%;
  }
  input[name = content] {
    display: none;
  }
  input[name = content]: checked + label[class="navmenu"] {
    background: black
  }

  /* appearance of slider bar */
  .pagesliders {
    -webkit-appearance: none;
    background: #F48F2A;
    /*width: 15%;*/
    height: 10px;
    border-radius: 100px; /* rounding the slider bars */
    opacity: 2;
    /*margin: auto;*/
  }

  /* appearance of the slider thumb thing */
  .pagesliders::-webkit-slider-thumb {
    -webkit-appearance: none;
    cursor: pointer;
    background: white;
    width: 15px;
    height: 15px;
    border-radius: 50%;
  }

  /* appearance of box to display text in */
  .displayBox {
    width: 400px;
    border-radius: 20px;
    height: 400px;
    margin: auto;
    text-align: center;
    background-color: #ffce00;
    color: #353840;
    border: 2px solid white;
  }

  /*appearance of the text boxes that comput prints to*/
  .textbox {
    width: 150px;
    height: 15px;
  }

  /*footer news headlines*/
  .footer {
    width: 100%;
    position: fixed;
    text-align: center;
    background-color: gray;
    color: white;
    bottom: 0;
    left: 0;
    height: 50px;
  }

  .flex-container {
      display: flex;
  }

  .flex-child {
      flex: 1;
  }

  .flex-child:first-child {
      margin-right: 20px;
  }

  #API_tables {
    font-family:'Montserrat';
    font-size: small;
    display:flex;
    flex-direction: row;
    justify-content: space-evenly;
    flex-wrap: nowrap;
  }

  table{
    width: 300px;
    margin: auto;
  }

  </style>

</head>

<body>
  <br><br>
  <!-- elements of navigation menu - series of radio buttons that control each tab -->
  <div id="wrapper" style = "margin-top: -30px">
    <!-- instruction tab -->
    <div> <input type = 'radio' name = 'content' id = 'ins_lontent' checked = 'true' onclick = "display()"/>
      <label for='ins_lontent' class="navmenu" id=ins_l style="background-color:gray">INSTRUCTIONS</label> </div>

    <!-- news tab -->
    <div> <input type = 'radio' name = 'content' id = 'news_lontent' checked = 'true' onclick = "display()"/>
      <label for='news_lontent' class="navmenu" id=news_l>NEWS</label> </div>

    <!-- stock finder tab -->
    <div> <input type = 'radio' name = 'content' id = 'stk_lontent' checked = 'true' onclick = "display()"/>
      <label for='stk_lontent' class="navmenu" id=stk_l>STOCK FINDER</label> </div>
  </div>
  <br>
        <div class="flex-container">
          <div id="instructions" class="flex-child" align="center">
            <br><br>
            <div class= 'displayBox'>
              <h1>Welcome to the Stock Finder!</h1>
              <p>Click on the "Stock Finder" tab to find the best stock to add to your investment portfolio. Customize your preferred stock price, PE ratio and net worth that align with your trading needs.
                Use the "Stock Search" tab to view data on your favorite stocks, and compare to top competitors or other potential investments.
                See what's happening in the Stock Market today with the "News" tab. View the top news stories affecting market trends before making your next investment.
              </p>
            </div>
          </div>

          <div id="ins-twitter-timeline" class="flex-child" align="center">
          <a class="twitter-timeline"
            href="https://twitter.com/YahooFinance?ref_src=twsrc%5Etfw"
            data-width=600px
            data-height=600px>
            Tweets by YahooFinance</a>
          <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
          </div>
        </div>

        <div class="flex-container">
          <div id="news" class ="flex-child" style="display:none">
            <br><br>
            <div class="column">
              <div id="title1"></div>
              <img src = "image1">
              <p><div id="text1"></div></p>
              <br><br>
              <div id="title2"></div>
              <img src=image2>
              <p><div id="text2"></div></p>
              <br><br>
              <div id="title3"></div>
              <img src=image3>
              <p><div id="text3"></div></p>
              <br><br>
              <div id="title4"></div>
              <img src=image4>
              <p><div id="text4"></div></p>
            </div>
          </div>

          <div id="news-twitter-timeline" class="flex-child" align="center" style="display:none">
          <a class="twitter-timeline"
            href="https://twitter.com/YahooFinance?ref_src=twsrc%5Etfw"
            data-width=600px
            data-height=600px>
            Tweets by YahooFinance</a>
          <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
          </div>
        </div>

        <script>
        fetch("https://finnhub.io/api/v1/news?category=general&token=btnr6jn48v6p0j27hpd0").then(r => r.json()).then(data => {
          document.getElementById("title1").innerHTML = data[0].headline
          document.getElementById("title2").innerHTML = data[1].headline
          document.getElementById("title3").innerHTML = data[2].headline
          document.getElementById("title4").innerHTML = data[3].headline

          document.getElementById("text1").innerHTML = data[0].summary
          document.getElementById("text2").innerHTML = data[1].summary
          document.getElementById("text3").innerHTML = data[2].summary
          document.getElementById("text4").innerHTML = data[3].summary

          document.getElementById("image1").innerHTML = data[0].image
          document.getElementById("image2").innerHTML = data[1].image
          document.getElementById("image3").innerHTML = data[2].image
          document.getElementById("image4").innerHTML = data[3].image

          document.getElementById("url1").innerHTML = data[0].url
          document.getElementById("url2").innerHTML = data[1].url
          document.getElementById("url3").innerHTML = data[2].url
          document.getElementById("url4").innerHTML = data[3].url
        });
        </script>



        <div id="stockfinder" style="display:none">
          <!-- adding compute button -->
          <br><br>

          <!-- ADDING SLIDERS TO PAGE -->
          <!-- first slider >
          <div class="rangeslider">
            <span>Min Stock Price: <span id="value1"></span></span><br>
            <input type="range" min="0" max="5000" value ="0" class="pagesliders" id="sliderRange1">
            <br><br>
            <! commented out the textbox that the compute button ties to,
            can use the compute button for something else
            <input type="text" id="firstVal" style="text-align:center" class = "textbox"><br> >
          </div-->

          <!-- second slider
          <div class="rangeslider">
            <span>Max Stock Price: <span id="value2"></span></span><br>
            <input type="range" min="0" max="5000" value ="0" class="pagesliders" id="sliderRange2">
            <br><br>
            <! <input type="text" id="secondVal" style="text-align:center" class = "textbox"><br> >
          </div-->

          <!-- third slider
          <div class="rangeslider">
            <span>Min Price-to-Earnings Ratio: <span id="value3"></span></span><br>
            <input type="range" min="-50" max="50" value ="0" step="0.01" class="pagesliders" id="sliderRange3">
            <br><br>
          </div-->

          <!-- fourth slider
          <div class="rangeslider">
            <span>Max Price-to-Earnings Ratio: <span id="value4"></span></span><br>
            <input type="range" min="-50" max="50" value ="0" step="0.01" class="pagesliders" id="sliderRange4">
            <br><br>
          </div-->

          <!-- fifth slider
          <div class="rangeslider">
            <span>Min Market Cap (in Billions): $<span id="value5"></span></span><br>
            <input type="range" min="0" max="100" value ="0" step="0.1" class="pagesliders" id="sliderRange5">
            <br><br>
          </div-->

          <!-- sixth slider
          <div class="rangeslider">
            <span>Max Market Cap (in Billions): $<span id="value6"></span></span><br>
            <input type="range" min="0" max="100" value ="0" step="0.1" class="pagesliders" id="sliderRange6">
            <br><br>
          </div-->
        <div class="flex-container">
          <div class="flex-child" style= "flex: 1 2 auto;">
            <p style="width:350px; font-size:medium;">Min/Max Stock Price:</p>
            <div style="width:350px;  display:flex; justify-content:space-between">
              <input type="number" id="Min_SP" style="width:50px">
              <div id=slider1 class="pagesliders" style="margin:10px; width:200px"> </div>
              <input type="number" id="Max_SP" style="width:50px">
            </div>
            <p style="width:350px; font-size:medium; ">Min/Max Price-to-Earnings Ratio:</p>
            <div style="width:350px; display:flex; justify-content:space-between">
              <input type="number" id="Min_PE" style="width:50px">
              <div id=slider2 class="pagesliders" style="margin:10px; width:200px"> </div>
              <input type="number" id="Max_PE" style="width:50px">
            </div>
            <p style="width:350px; font-size:medium; ">Min/Max Market Cap (in Billions of dollars):</p>
            <div style="width:350px; display:flex; justify-content:space-between">
              <input type="number" id="Min_MC" style="width:50px">
              <div id=slider3 class="pagesliders" style="margin:10px; width:200px"> </div>
              <input type="number" id="Max_MC" style="width:50px">
            </div>
            <br>
            <div class='rangeslider'>
              <text>Stock Trend: </text>
              <input type="radio" id="stockUp" name="stockTrend" value="up">
              <label for="up">Up</label>
              <input type="radio" id="stockDown" name="stockTrend" value="down">
              <label for="down">Down</label>
            </div>
          <script>
            //Script for the slider here
            $(function() {
              $( "#slider1" ).slider({
                range: true,
                min: 0,
                max: 5000,
                values: [ 0, 5000 ],
                slide: function( event, ui ) {
                  $("#Min_SP").val(ui.values[0]);
                  $("#Max_SP").val(ui.values[1]);
                }
              });
              $("#Min_SP").val($("#slider1").slider("values",0));
              $("#Max_SP").val($("#slider1").slider("values",1));
              $("#Min_SP").on("input",function(){
                $("#slider1").slider("values",0,$("#Min_SP").val())
              });
              $("#Max_SP").on("input",function(){
                $("#slider1").slider("values",1,$("#Max_SP").val())
              });
            } );
            $(function() {
              $( "#slider2" ).slider({
                range: true,
                min: -50,
                max: 50,
                values: [ -5, 5 ],
                slide: function( event, ui ) {
                  $("#Min_PE").val(ui.values[0]);
                  $("#Max_PE").val(ui.values[1]);
                }
              });
              $("#Min_PE").val($("#slider2").slider("values",0));
              $("#Max_PE").val($("#slider2").slider("values",1));
              $("#Min_PE").on("input",function(){
                $("#slider2").slider("values",0,$("#Min_PE").val())
              });
              $("#Max_PE").on("input",function(){
                $("#slider2").slider("values",1,$("#Max_PE").val())
              });
            } );
            $(function() {
              $( "#slider3" ).slider({
                range: true,
                min: 0,
                max: 100,
                values: [ 0, 100 ],
                slide: function( event, ui ) {
                  $("#Min_MC").val(ui.values[0]);
                  $("#Max_MC").val(ui.values[1]);
                }
              });
              $("#Min_MC").val($("#slider3").slider("values",0));
              $("#Max_MC").val($("#slider3").slider("values",1));
              $("#Min_MC").on("input",function(){
                $("#slider3").slider("values",0,$("#Min_MC").val())
              });
              $("#Max_MC").on("input",function(){
                $("#slider3").slider("values",1,$("#Max_MC").val())
              });
            } );

          </script>

          <div>
            <input id="slidersReset" type="button" value="Reset">
            <button type="button" onclick="getStock()">Compute</button>
          </div>
          <script>
            $('#slidersReset').click(function(){
              $("#Min_SP").val(0);
              $("#Max_SP").val(5000);
              $("#Min_PE").val(-5);
              $("#Max_PE").val(5);
              $("#Min_MC").val(0);
              $("#Max_MC").val(100);
              $("#Min_SP").trigger("input");
              $("#Max_PE").trigger("input");
              $("#Min_PE").trigger("input");
              $("#Max_SP").trigger("input");
              $("#Min_MC").trigger("input");
              $("#Max_MC").trigger("input");
              //$('#stockUp').attr('checked',false);
              //$('#stockDown').attr('checked',false);
              document.getElementById("stockUp").checked = false;
              document.getElementById("stockDown").checked = false;
            });
          </script>
        </div>

          <div class="flex-child" style=" flex: 2 1 auto;">
            <table border=1 width=200 cellpadding=10>
              <tr>
                <td>
                  <p>Stock Symbol</p>
                </td>
                <td>
                  <p>Company Name</p>
                </td>
                <td>
                  <p>Current Stock Price</p>
                </td>
                <td>
                  <p>Market Cap</p>
                </td>
                <td>
                  <p>Last Annual Dividend</p>
                </td>
                <td>
                  <p>Sector</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 1 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 1 companyName"</p>
                </td>
                <td>
                  <p id="Stock 1 Price"</p>
                </td>
                <td>
                  <p id="Stock 1 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 1 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 1 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 2 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 2 companyName"</p>
                </td>
                <td>
                  <p id="Stock 2 Price"</p>
                </td>
                <td>
                  <p id="Stock 2 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 2 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 2 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 3 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 3 companyName"</p>
                </td>
                <td>
                  <p id="Stock 3 Price"</p>
                </td>
                <td>
                  <p id="Stock 3 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 3 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 3 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 4 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 4 companyName"</p>
                </td>
                <td>
                  <p id="Stock 4 Price"</p>
                </td>
                <td>
                  <p id="Stock 4 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 4 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 4 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 5 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 5 companyName"</p>
                </td>
                <td>
                  <p id="Stock 5 Price"</p>
                </td>
                <td>
                  <p id="Stock 5 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 5 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 5 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 6 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 6 companyName"</p>
                </td>
                <td>
                  <p id="Stock 6 Price"</p>
                </td>
                <td>
                  <p id="Stock 6 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 6 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 6 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 7 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 7 companyName"</p>
                </td>
                <td>
                  <p id="Stock 7 Price"</p>
                </td>
                <td>
                  <p id="Stock 7 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 7 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 7 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 8 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 8 companyName"</p>
                </td>
                <td>
                  <p id="Stock 8 Price"</p>
                </td>
                <td>
                  <p id="Stock 8 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 8 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 8 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 9 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 9 companyName"</p>
                </td>
                <td>
                  <p id="Stock 9 Price"</p>
                </td>
                <td>
                  <p id="Stock 9 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 9 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 9 Sector"</p>
                </td>
              </tr>
              <tr>
                <td>
                  <p id="Stock 10 Symbol"></p>
                </td>
                <td>
                  <p id="Stock 10 companyName"</p>
                </td>
                <td>
                  <p id="Stock 10 Price"</p>
                </td>
                <td>
                  <p id="Stock 10 Market Cap"></p>
                </td>
                <td>
                  <p id="Stock 10 Last Annual Dividend"</p>
                </td>
                <td>
                  <p id="Stock 10 Sector"</p>
                </td>
              </tr>
            </table>



          <div id='stockstats'>
            <h3 class=text-center>View Stock Info</h3>
            <div class=text-center>
              <label for="symbol">Stock symbol:</label> <input type=text id='symbol' size=5>
              <button type=button id='symbolbutton' onclick="stockbutton()"
              disabled>Add</button>
              <br>
            </div>

          </div>
          <div id = "API_tables"> </div>
          <br>
          <div id='stat_buttons' class="text-center" style='display:none'>
            <button onclick=tableclear()>Clear All</button>
            <button onclick=refreshAll()>Refresh All</button>
          </div>
          <p id=tablemessage class="text-center"></p>

          <hr>
        </div>
        </div>

        <!-- adding footer news headline -->
        <div class = "footer">
          <strong>Top Market News Headlines:</strong>
          <div id="NewsHeadline">
          </div>
        </div>
      </div>

        <!-- SCRIPTS -->

        <script>// Zoe's Headline code (I'd like this to be done first)


        $('#NewsHeadline').hide();
        fetch("https://finnhub.io/api/v1/news?category=general&token=btnr6jn48v6p0j27hpd0").then(r => r.json()).then(data => {
          let i=0;
          let s="";
          for(let c=0; c<10; c++){
            let h = data[i].headline;
            let u = data[i].url;
            i++;
            if(h===""){
              c--;
              continue;
            }
            $("#NewsHeadline").append(`<a href='${u}' target=_blank>${h}</a>`);
            if(c!==9)
              $("#NewsHeadline").append(" &nbsp;&nbsp;|| &nbsp;&nbsp;");
          }
          $('#NewsHeadline').marquee({
            pauseOnHover:true,
            speed:100
          });

        }, r => {$("#NewsHeadline").html() = "API fetch failed";})
        $('#NewsHeadline').show();
        </script>

        <!--script to control display of tabs -->
        <script>
        function display() {
          let ins = document.getElementById('instructions'); // refers to content of instructions tab
          let news = document.getElementById('news'); // refers to content of news tab
          let stk = document.getElementById('stockfinder'); // refers to content of stock finder tab
          let ins_twit = document.getElementById('ins-twitter-timeline');
          let news_twit = document.getElementById('news-twitter-timeline');

          let ins_l = document.getElementById("ins_l");
          let news_l = document.getElementById("news_l");
          let stk_l = document.getElementById("stk_l");
          if (document.getElementById("ins_lontent").checked) { // instruction tab is selected
            ins.style.display = "block";
            ins_twit.style.display = "block"
            news.style.display = "none";
            news_twit.style.display = "none"
            stk.style.display = "none";
            ins_l.style["background-color"]="gray";
            news_l.style["background-color"]="";
            stk_l.style["background-color"]="";
          }

          if (document.getElementById("news_lontent").checked) { // news tab is selected
            ins.style.display = "none";
            ins_twit.style.display = "none"
            news.style.display = "block";
            news_twit.style.display = "block"
            stk.style.display = "none";
            ins_l.style["background-color"]="";
            news_l.style["background-color"]="gray";
            stk_l.style["background-color"]="";
          }

          if (document.getElementById("stk_lontent").checked) { // stock finder tab is selected
            ins.style.display = "none";
            ins_twit.style.display = "none"
            news.style.display = "none";
            news_twit.style.display = "none"
            stk.style.display = "block";
            ins_l.style["background-color"]="";
            news_l.style["background-color"]="";
            stk_l.style["background-color"]="gray";
          }
        }
        </script>
        <!-- script to display value of sliders  -->
        <script>/*
        var rangeslider1 = document.getElementById("sliderRange1");
        var output1 = document.getElementById("value1");
        output1.innerHTML = rangeslider1.value;

        rangeslider1.oninput = function() {
          output1.innerHTML = this.value;
        }

        var rangeslider2 = document.getElementById("sliderRange2");
        var output2 = document.getElementById("value2");
        output2.innerHTML = rangeslider2.value;

        rangeslider2.oninput = function() {
          output2.innerHTML = this.value;
        }

        var rangeslider3 = document.getElementById("sliderRange3");
        var output3 = document.getElementById("value3");
        output3.innerHTML = rangeslider3.value;

        rangeslider3.oninput = function() {
          output3.innerHTML = this.value;
        }

        var rangeslider4 = document.getElementById("sliderRange4");
        var output4 = document.getElementById("value4");
        output4.innerHTML = rangeslider4.value;

        rangeslider4.oninput = function() {
          output4.innerHTML = this.value;
        }

        var rangeslider5 = document.getElementById("sliderRange5");
        var output5 = document.getElementById("value5");
        output5.innerHTML = rangeslider5.value;

        rangeslider5.oninput = function() {
          output5.innerHTML = this.value;
        }

        var rangeslider6 = document.getElementById("sliderRange6");
        var output6 = document.getElementById("value6");
        output6.innerHTML = rangeslider6.value;

        rangeslider6.oninput = function() {
          output6.innerHTML = this.value;
        }*/

        // reset button for SLIDERS code
        /*
        document.getElementById('slidersReset').onclick = function(){
          document.getElementById('sliderRange1').value = 0;
          document.getElementById('sliderRange2').value = 0;
          document.getElementById('sliderRange3').value = 0;
          document.getElementById('sliderRange4').value = 0;
          document.getElementById('sliderRange5').value = 0;
          document.getElementById('sliderRange6').value = 0;
          document.getElementById('value1').innerHTML = 0;
          document.getElementById('value2').innerHTML = 0;
          document.getElementById('value3').innerHTML = 0;
          document.getElementById('value4').innerHTML = 0;
          document.getElementById('value5').innerHTML = 0;
          document.getElementById('value6').innerHTML = 0;
          var ele = document.getElementsByName("stockTrend");
          for(var i=0;i<ele.length;i++)
          ele[i].checked = false;
        };*/


        //<!--- the functions for print out slider values to text boxes-->
        function slider1Function() {
          document.getElementById("firstVal").value = document.getElementById("sliderRange1").value;
        }
        function slider2Function() {
          document.getElementById("secondVal").value = document.getElementById("sliderRange2").value;
        }

        function getStock() {
          var minMC = $("#slider3").slider("values",0,$("#Min_MC").val()) * 1000000000;
          var maxMC = $("#slider3").slider("values",1,$("#Max_MC").val()) * 1000000000;
          var stringMin = minMC.toString();
          var stringMax = maxMC.toString();
          fetch("https://financialmodelingprep.com/api/v3/stock-screener?marketCapMoreThan="+stringMin+"&marketCapLessThan="+stringMax+"&sector=Technology&exchange=NASDAQ&dividendMoreThan=0&limit=100&apikey=83de5b39af0c5c7e1b5c156e8bc04eaf").then(r => r.json()).then(data=>{
            document.getElementById("Stock 1 Symbol").innerHTML = data[0].symbol;
            document.getElementById("Stock 1 companyName").innerHTML = data[0].companyName;
            document.getElementById("Stock 1 Price").innerHTML = data[0].price;
            document.getElementById("Stock 1 Market Cap").innerHTML = data[0].marketCap;
            document.getElementById("Stock 1 Last Annual Dividend").innerHTML = data[0].lastAnnualDividend;
            document.getElementById("Stock 1 Sector").innerHTML = data[0].sector;
            document.getElementById("Stock 2 Symbol").innerHTML = data[1].symbol;
            document.getElementById("Stock 2 companyName").innerHTML = data[1].companyName;
            document.getElementById("Stock 2 Price").innerHTML = data[1].price;
            document.getElementById("Stock 2 Market Cap").innerHTML = data[1].marketCap;
            document.getElementById("Stock 2 Last Annual Dividend").innerHTML = data[1].lastAnnualDividend;
            document.getElementById("Stock 2 Sector").innerHTML = data[1].sector;
            document.getElementById("Stock 3 Symbol").innerHTML = data[2].symbol;
            document.getElementById("Stock 3 companyName").innerHTML = data[2].companyName;
            document.getElementById("Stock 3 Price").innerHTML = data[2].price;
            document.getElementById("Stock 3 Market Cap").innerHTML = data[2].marketCap;
            document.getElementById("Stock 3 Last Annual Dividend").innerHTML = data[2].lastAnnualDividend;
            document.getElementById("Stock 3 Sector").innerHTML = data[2].sector;
            document.getElementById("Stock 4 Symbol").innerHTML = data[3].symbol;
            document.getElementById("Stock 4 companyName").innerHTML = data[3].companyName;
            document.getElementById("Stock 4 Price").innerHTML = data[3].price;
            document.getElementById("Stock 4 Market Cap").innerHTML = data[3].marketCap;
            document.getElementById("Stock 4 Last Annual Dividend").innerHTML = data[3].lastAnnualDividend;
            document.getElementById("Stock 4 Sector").innerHTML = data[3].sector;
            document.getElementById("Stock 5 Symbol").innerHTML = data[4].symbol;
            document.getElementById("Stock 5 companyName").innerHTML = data[4].companyName;
            document.getElementById("Stock 5 Price").innerHTML = data[4].price;
            document.getElementById("Stock 5 Market Cap").innerHTML = data[4].marketCap;
            document.getElementById("Stock 5 Last Annual Dividend").innerHTML = data[4].lastAnnualDividend;
            document.getElementById("Stock 5 Sector").innerHTML = data[4].sector;
            document.getElementById("Stock 6 Symbol").innerHTML = data[5].symbol;
            document.getElementById("Stock 6 companyName").innerHTML = data[5].companyName;
            document.getElementById("Stock 6 Price").innerHTML = data[5].price;
            document.getElementById("Stock 6 Market Cap").innerHTML = data[5].marketCap;
            document.getElementById("Stock 6 Last Annual Dividend").innerHTML = data[5].lastAnnualDividend;
            document.getElementById("Stock 6 Sector").innerHTML = data[5].sector;
            document.getElementById("Stock 7 Symbol").innerHTML = data[6].symbol;
            document.getElementById("Stock 7 companyName").innerHTML = data[6].companyName;
            document.getElementById("Stock 7 Price").innerHTML = data[6].price;
            document.getElementById("Stock 7 Market Cap").innerHTML = data[6].marketCap;
            document.getElementById("Stock 7 Last Annual Dividend").innerHTML = data[6].lastAnnualDividend;
            document.getElementById("Stock 7 Sector").innerHTML = data[6].sector;
            document.getElementById("Stock 8 Symbol").innerHTML = data[7].symbol;
            document.getElementById("Stock 8 companyName").innerHTML = data[7].companyName;
            document.getElementById("Stock 8 Price").innerHTML = data[7].price;
            document.getElementById("Stock 8 Market Cap").innerHTML = data[7].marketCap;
            document.getElementById("Stock 8 Last Annual Dividend").innerHTML = data[7].lastAnnualDividend;
            document.getElementById("Stock 8 Sector").innerHTML = data[7].sector;
            document.getElementById("Stock 9 Symbol").innerHTML = data[8].symbol;
            document.getElementById("Stock 9 companyName").innerHTML = data[8].companyName;
            document.getElementById("Stock 9 Price").innerHTML = data[8].price;
            document.getElementById("Stock 9 Market Cap").innerHTML = data[8].marketCap;
            document.getElementById("Stock 9 Last Annual Dividend").innerHTML = data[8].lastAnnualDividend;
            document.getElementById("Stock 9 Sector").innerHTML = data[8].sector;
            document.getElementById("Stock 10 Symbol").innerHTML = data[9].symbol;
            document.getElementById("Stock 10 companyName").innerHTML = data[9].companyName;
            document.getElementById("Stock 10 Price").innerHTML = data[9].price;
            document.getElementById("Stock 10 Market Cap").innerHTML = data[9].marketCap;
            document.getElementById("Stock 10 Last Annual Dividend").innerHTML = data[9].lastAnnualDividend;
            document.getElementById("Stock 10 Sector").innerHTML = data[9].sector;
          });
        }
        </script>

        <script>
        //<!-- API pull code -->
        var num_tables=0;
        var table_codes = [];
        document.getElementById("symbol").addEventListener("keyup", function(event) {
          var nameInput = document.getElementById('symbol').value;
          if (event.keyCode === 13 && nameInput != "" && num_tables<4) {
            // Cancel the default action, if needed
            //event.preventDefault();
            // Trigger the button element with a click
            document.getElementById("symbolbutton").click();/*
            stockbutton();
            document.getElementById('symbolbutton').setAttribute('disabled', true);
            document.getElementById('symbol').value = '';*/
          }
          else if (nameInput != "" && num_tables<4) {
            document.getElementById('symbolbutton').removeAttribute("disabled");
          } else {
            document.getElementById('symbolbutton').setAttribute("disabled", null);
          }
        });

        function stockbutton(){
          if(num_tables==4)
          return;
          //tablefetch(num_tables+1, document.getElementById("symbol").value.toUpperCase(), true);
          addTable($("#symbol").val().toUpperCase());
          //document.getElementById('symbolbutton').setAttribute('disabled', null);
          $('#symbolbutton').attr('disabled', null);
          //document.getElementById('symbol').value = '';
          $('#symbol').val("");
          //console.log(table_codes);
        }

        function addTable(code){
          if(typeof code==="undefined")
          return;
          if(table_codes.includes(code)){
            $("#tablemessage").html(code+" table already exists");
            return;
          }
          $("#tablemessage").html("Fetching...");
          fetch("https://finnhub.io/api/v1/quote?symbol="+code+"&token=btnr6jn48v6p0j27hpd0").then(r => r.json()).then(data=>{
            if(data.o==0 && data.h==0 && data.l==0 && data.c==0 && data.pc==0){
              $("#tablemessage").html("Invalid Stock Symbol");
            }
            else{
              let table_html = `
              <div id=table${code}>
              <table border=\"5\">
              <tr>
              <th colspan=\"5\"><br>
              <h3>${code} Stock Data</h3>
              </th>
              </tr>

              <th>Open</th>
              <th>High</th>
              <th>Low</th>
              <th>Current</th>
              <th>Previous Close</th>

              <tr>
              <td><div id=\"Open${code}\"></div></td>
              <td><div id=\"High${code}\"></div></td>
              <td><div id=\"Low${code}\"></div></td>
              <td><div id=\"Current${code}\"></div></td>
              <td><div id=\"PrevClose${code}\"></div></td>
              </tr>
              </table>
              <div class=text-center>
              <button onclick=removeTable(\"${code}\")>Delete</button>
              <button onclick=refresh(\"${code}\")>Refresh</button>
              </div>
              </div>
              `;
              $(table_html).appendTo("#API_tables");
              $("#Open"+code).html(data.o);
              $("#High"+code).html(data.h);
              $("#Low"+code).html(data.l);
              $("#Current"+code).html(data.c);
              $("#PrevClose"+code).html(data.pc);
              document.getElementById('stat_buttons').style.display="";
              $("#tablemessage").html("");
              table_codes.push(code);
              num_tables++;
            }
          }, error=>{$("tablemessage").html("Fetch Failed")});
        }

        function removeTable(code){
          num_tables--;
          let n = table_codes.indexOf(code);
          table_codes.splice(n,1); //remove from table
          $(`#table${code}`).remove();
          if(num_tables==0)
          document.getElementById('stat_buttons').style.display="none";
        }
        function refresh(code){
          $("#tablemessage").html("Fetching...");
          fetch("https://finnhub.io/api/v1/quote?symbol="+code+"&token=btnr6jn48v6p0j27hpd0").then(r => r.json()).then(data=>{
            $("#Open"+code).html(data.o);
            $("#High"+code).html(data.h);
            $("#Low"+code).html(data.l);
            $("#Current"+code).html(data.c);
            $("#PrevClose"+code).html(data.pc);
            $("#tablemessage").html("");
          }, error=>{document.getElementById("tablemessage").innerHTML = "Fetch Failed"})
        }
        /*
        function tablefetch(n, code, increment=false){
        //const n = num_tables+1;
        if(increment && table_codes.includes(code)){
        document.getElementById("tablemessage").innerHTML = "Enter a different code";
        return;
      }

      document.getElementById("tablemessage").innerHTML = "Fetching...";
      fetch("https://finnhub.io/api/v1/quote?symbol="+code+"&token=btnr6jn48v6p0j27hpd0").then(r => r.json()).then(data=>{
      if(data.o==0 && data.h==0 && data.l==0 && data.c==0 && data.pc==0){
      document.getElementById("tablemessage").innerHTML = "Invalid Stock Symbol";
    }
    else{
    document.getElementById("Open"+n).innerHTML = data.o;
    document.getElementById("High"+n).innerHTML = data.h;
    document.getElementById("Low"+n).innerHTML = data.l;
    document.getElementById("Current"+n).innerHTML = data.c;
    document.getElementById("PrevClose"+n).innerHTML = data.pc;
    document.getElementById("Title"+n).innerHTML = code+" Stock Info";
    document.getElementById('t'+n).style.display="";
    document.getElementById('stat_buttons').style.display="";
    document.getElementById("tablemessage").innerHTML = "";
    if(increment){
    table_codes[num_tables] = code;
    num_tables++;
  }
}
}, error=>{document.getElementById("tablemessage").innerHTML = "Fetch Failed"});
}
*/
function refreshAll(){
  console.log(num_tables);
  for(let i=0; i<num_tables; i++){
    console.log(table_codes[i]);
    refresh(table_codes[i]);
  }
}
function tableclear(){
  console.log(table_codes);
  for(let i=num_tables-1; i>=0; i--){
    //document.getElementById('t'+(i+1)).style.display="none";
    removeTable(table_codes[i]);
  }
  document.getElementById('stat_buttons').style.display="none";
  num_tables=0;
  table_codes=[];
  document.getElementById("tablemessage").innerHTML = "";
}

/*
// Hongze's cat API
fetch("https://aws.random.cat/meow").then(
r => r.json()).then(r => {document.getElementById("cat").src = r.file})//{document.getElementById("numFact").innerHTML = r})
*/
</script>

</body>

</html>
